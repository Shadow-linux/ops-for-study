(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4a86dd1e"],{"00d87":function(t,e){(function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&a.rotl(t,8)|4278255360&a.rotl(t,24);for(var e=0;e<t.length;e++)t[e]=a.endian(t[e]);return t},randomBytes:function(t){for(var e=[];t>0;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],a=0,r=0;a<t.length;a++,r+=8)e[r>>>5]|=t[a]<<24-r%32;return e},wordsToBytes:function(t){for(var e=[],a=0;a<32*t.length;a+=8)e.push(t[a>>>5]>>>24-a%32&255);return e},bytesToHex:function(t){for(var e=[],a=0;a<t.length;a++)e.push((t[a]>>>4).toString(16)),e.push((15&t[a]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],a=0;a<t.length;a+=2)e.push(parseInt(t.substr(a,2),16));return e},bytesToBase64:function(t){for(var a=[],r=0;r<t.length;r+=3)for(var n=t[r]<<16|t[r+1]<<8|t[r+2],o=0;o<4;o++)8*r+6*o<=8*t.length?a.push(e.charAt(n>>>6*(3-o)&63)):a.push("=");return a.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var a=[],r=0,n=0;r<t.length;n=++r%4)0!=n&&a.push((e.indexOf(t.charAt(r-1))&Math.pow(2,-2*n+8)-1)<<2*n|e.indexOf(t.charAt(r))>>>6-2*n);return a}};t.exports=a})()},3846:function(t,e,a){a("9e1e")&&"g"!=/./g.flags&&a("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:a("0bfb")})},"6821f":function(t,e,a){(function(){var e=a("00d87"),r=a("9a63").utf8,n=a("044b"),o=a("9a63").bin,i=function(t,a){t.constructor==String?t=a&&"binary"===a.encoding?o.stringToBytes(t):r.stringToBytes(t):n(t)?t=Array.prototype.slice.call(t,0):Array.isArray(t)||(t=t.toString());for(var s=e.bytesToWords(t),c=8*t.length,l=1732584193,d=-271733879,u=-1732584194,h=271733878,p=0;p<s.length;p++)s[p]=16711935&(s[p]<<8|s[p]>>>24)|4278255360&(s[p]<<24|s[p]>>>8);s[c>>>5]|=128<<c%32,s[14+(c+64>>>9<<4)]=c;var m=i._ff,_=i._gg,f=i._hh,b=i._ii;for(p=0;p<s.length;p+=16){var v=l,g=d,F=u,k=h;l=m(l,d,u,h,s[p+0],7,-680876936),h=m(h,l,d,u,s[p+1],12,-389564586),u=m(u,h,l,d,s[p+2],17,606105819),d=m(d,u,h,l,s[p+3],22,-1044525330),l=m(l,d,u,h,s[p+4],7,-176418897),h=m(h,l,d,u,s[p+5],12,1200080426),u=m(u,h,l,d,s[p+6],17,-1473231341),d=m(d,u,h,l,s[p+7],22,-45705983),l=m(l,d,u,h,s[p+8],7,1770035416),h=m(h,l,d,u,s[p+9],12,-1958414417),u=m(u,h,l,d,s[p+10],17,-42063),d=m(d,u,h,l,s[p+11],22,-1990404162),l=m(l,d,u,h,s[p+12],7,1804603682),h=m(h,l,d,u,s[p+13],12,-40341101),u=m(u,h,l,d,s[p+14],17,-1502002290),d=m(d,u,h,l,s[p+15],22,1236535329),l=_(l,d,u,h,s[p+1],5,-165796510),h=_(h,l,d,u,s[p+6],9,-1069501632),u=_(u,h,l,d,s[p+11],14,643717713),d=_(d,u,h,l,s[p+0],20,-373897302),l=_(l,d,u,h,s[p+5],5,-701558691),h=_(h,l,d,u,s[p+10],9,38016083),u=_(u,h,l,d,s[p+15],14,-660478335),d=_(d,u,h,l,s[p+4],20,-405537848),l=_(l,d,u,h,s[p+9],5,568446438),h=_(h,l,d,u,s[p+14],9,-1019803690),u=_(u,h,l,d,s[p+3],14,-187363961),d=_(d,u,h,l,s[p+8],20,1163531501),l=_(l,d,u,h,s[p+13],5,-1444681467),h=_(h,l,d,u,s[p+2],9,-51403784),u=_(u,h,l,d,s[p+7],14,1735328473),d=_(d,u,h,l,s[p+12],20,-1926607734),l=f(l,d,u,h,s[p+5],4,-378558),h=f(h,l,d,u,s[p+8],11,-2022574463),u=f(u,h,l,d,s[p+11],16,1839030562),d=f(d,u,h,l,s[p+14],23,-35309556),l=f(l,d,u,h,s[p+1],4,-1530992060),h=f(h,l,d,u,s[p+4],11,1272893353),u=f(u,h,l,d,s[p+7],16,-155497632),d=f(d,u,h,l,s[p+10],23,-1094730640),l=f(l,d,u,h,s[p+13],4,681279174),h=f(h,l,d,u,s[p+0],11,-358537222),u=f(u,h,l,d,s[p+3],16,-722521979),d=f(d,u,h,l,s[p+6],23,76029189),l=f(l,d,u,h,s[p+9],4,-640364487),h=f(h,l,d,u,s[p+12],11,-421815835),u=f(u,h,l,d,s[p+15],16,530742520),d=f(d,u,h,l,s[p+2],23,-995338651),l=b(l,d,u,h,s[p+0],6,-198630844),h=b(h,l,d,u,s[p+7],10,1126891415),u=b(u,h,l,d,s[p+14],15,-1416354905),d=b(d,u,h,l,s[p+5],21,-57434055),l=b(l,d,u,h,s[p+12],6,1700485571),h=b(h,l,d,u,s[p+3],10,-1894986606),u=b(u,h,l,d,s[p+10],15,-1051523),d=b(d,u,h,l,s[p+1],21,-2054922799),l=b(l,d,u,h,s[p+8],6,1873313359),h=b(h,l,d,u,s[p+15],10,-30611744),u=b(u,h,l,d,s[p+6],15,-1560198380),d=b(d,u,h,l,s[p+13],21,1309151649),l=b(l,d,u,h,s[p+4],6,-145523070),h=b(h,l,d,u,s[p+11],10,-1120210379),u=b(u,h,l,d,s[p+2],15,718787259),d=b(d,u,h,l,s[p+9],21,-343485551),l=l+v>>>0,d=d+g>>>0,u=u+F>>>0,h=h+k>>>0}return e.endian([l,d,u,h])};i._ff=function(t,e,a,r,n,o,i){var s=t+(e&a|~e&r)+(n>>>0)+i;return(s<<o|s>>>32-o)+e},i._gg=function(t,e,a,r,n,o,i){var s=t+(e&r|a&~r)+(n>>>0)+i;return(s<<o|s>>>32-o)+e},i._hh=function(t,e,a,r,n,o,i){var s=t+(e^a^r)+(n>>>0)+i;return(s<<o|s>>>32-o)+e},i._ii=function(t,e,a,r,n,o,i){var s=t+(a^(e|~r))+(n>>>0)+i;return(s<<o|s>>>32-o)+e},i._blocksize=16,i._digestsize=16,t.exports=function(t,a){if(void 0===t||null===t)throw new Error("Illegal argument "+t);var r=e.wordsToBytes(i(t,a));return a&&a.asBytes?r:a&&a.asString?o.bytesToString(r):e.bytesToHex(r)}})()},"6b54":function(t,e,a){"use strict";a("3846");var r=a("cb7c"),n=a("0bfb"),o=a("9e1e"),i="toString",s=/./[i],c=function(t){a("2aba")(RegExp.prototype,i,t,!0)};a("79e5")(function(){return"/a/b"!=s.call({source:"a",flags:"b"})})?c(function(){var t=r(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?n.call(t):void 0)}):s.name!=i&&c(function(){return s.call(this)})},"7c49":function(t,e,a){"use strict";a.d(e,"g",function(){return i}),a.d(e,"l",function(){return s}),a.d(e,"a",function(){return c}),a.d(e,"m",function(){return l}),a.d(e,"c",function(){return d}),a.d(e,"b",function(){return u}),a.d(e,"d",function(){return h}),a.d(e,"e",function(){return p}),a.d(e,"f",function(){return m}),a.d(e,"h",function(){return _}),a.d(e,"j",function(){return f}),a.d(e,"k",function(){return b}),a.d(e,"i",function(){return v});var r=a("66df"),n=a("6821f"),o={pp:n("app_management")},i=function(){return r["a"].request({url:"/api/v1/app/detail/",method:"get",headers:o})},s=function(t){return r["a"].request({url:"/api/v1/app/detail/".concat(t,"/"),method:"get",headers:o})},c=function(t){return r["a"].request({url:"/api/v1/app/detail/",method:"post",data:t,headers:o})},l=function(t,e){return r["a"].request({url:"/api/v1/app/detail/".concat(t,"/"),method:"put",data:e,headers:o})},d=function(t){return r["a"].request({url:"/api/v1/app/detail/".concat(t,"/"),method:"delete",headers:o})},u=function(t){return r["a"].request({url:"/api/v1/app/alive/urlooker/",method:"post",data:t,headers:o})},h=function(t){return r["a"].request({url:"/api/v1/app/alive/urlooker/".concat(t),method:"delete",headers:o})},p=function(){return r["a"].request({url:"/api/v1/cmdb/common/all-hosts/",method:"get",headers:o})},m=function(){return r["a"].request({url:"/api/v1/users/open/",method:"get",headers:o})},_=function(t){return r["a"].request({url:"/api/v1/app/rel/host/".concat(t,"/"),method:"get",headers:o})},f=function(){return r["a"].request({url:"/api/v1/common/setting/cmdb/",method:"get",headers:o})},b=function(){return r["a"].request({url:"/api/v1/common/setting/app/",method:"get",headers:o})},v=function(){return r["a"].request({url:"/api/v1/common/setting/app/",method:"get",headers:o})}},"9a63":function(t,e){var a={utf8:{stringToBytes:function(t){return a.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(a.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],a=0;a<t.length;a++)e.push(255&t.charCodeAt(a));return e},bytesToString:function(t){for(var e=[],a=0;a<t.length;a++)e.push(String.fromCharCode(t[a]));return e.join("")}}};t.exports=a},c7e7:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",[a("p",{attrs:{slot:"title"},slot:"title"},[t._v("App 管理")]),a("div",{staticStyle:{"margin-bottom":"10px"}},[a("Button",{attrs:{type:"primary",ghost:""},on:{click:t.addApp}},[t._v("添加应用")]),a("Button",{staticStyle:{float:"right"},on:{click:function(){t.reloadTable()}}},[t._v("刷新")])],1),a("Row",{staticStyle:{height:"50px"}},[a("Col",{staticStyle:{"margin-top":"10px"},attrs:{span:"8"}},[a("Poptip",{attrs:{confirm:"",title:"确认删除吗 ?",placement:"right-start"},on:{"on-ok":t.deleteOk}},[a("Button",{attrs:{size:"small"}},[t._v("删除")])],1),a("Button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"},on:{click:t.handleBatchControlHost}},[t._v("批量操作关联主机")]),a("Button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"},on:{click:t.handleBatchControlEnv}},[t._v("批量操作更改监控环境")])],1),a("Col",{attrs:{span:"6",offset:"10"}},[a("Checkbox",{model:{value:t.appUsed,callback:function(e){t.appUsed=e},expression:"appUsed"}},[t._v("使用中")]),a("Input",{staticStyle:{width:"78%"},attrs:{search:"",placeholder:"搜索App名字"},on:{"on-keyup":function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.enterSearch(e):null}},model:{value:t.searchValue,callback:function(e){t.searchValue="string"===typeof e?e.trim():e},expression:"searchValue"}})],1)],1),a("span",{staticStyle:{"font-size":"12px",color:"#808695"}},[t._v("总数: "+t._s(t.pageTotal))]),a("Table",{attrs:{loading:t.tableLoading,"max-height":"1024",columns:t.tableColumns,data:t.tableDatas},on:{"on-selection-change":t.selectChange}}),a("br")],1),a("Modal",{attrs:{title:t.editModalTitle,"mask-closable":!1},on:{"on-ok":function(e){t.editOk("dataForm")}},model:{value:t.editModal,callback:function(e){t.editModal=e},expression:"editModal"}},[a("Alert",{attrs:{type:"warning","show-icon":""}},[t._v("✳️号为辅助检查项。")]),a("Form",{ref:"dataForm",attrs:{model:t.dataForm,rules:t.ruleDataForm,"label-width":120}},[a("FormItem",{attrs:{label:"应用名:",prop:"app_name"}},[a("Input",{model:{value:t.dataForm.app_name,callback:function(e){t.$set(t.dataForm,"app_name","string"===typeof e?e.trim():e)},expression:"dataForm.app_name"}})],1),a("FormItem",{attrs:{label:"应用端口:",prop:"port"}},[a("Input",{model:{value:t.dataForm.port,callback:function(e){t.$set(t.dataForm,"port","string"===typeof e?e.trim():e)},expression:"dataForm.port"}})],1),a("FormItem",{attrs:{label:"描述:",prop:"description"}},[a("Input",{model:{value:t.dataForm.description,callback:function(e){t.$set(t.dataForm,"description","string"===typeof e?e.trim():e)},expression:"dataForm.description"}})],1),a("FormItem",{attrs:{label:"服务:",prop:"service"}},[a("Select",{attrs:{filterable:""},model:{value:t.dataForm.service,callback:function(e){t.$set(t.dataForm,"service",e)},expression:"dataForm.service"}},t._l(t.serviceList,function(e){return a("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])}))],1),a("FormItem",{attrs:{label:"联系人:",prop:"connector"}},[a("Select",{attrs:{filterable:"",multiple:""},model:{value:t.dataForm.connector,callback:function(e){t.$set(t.dataForm,"connector",e)},expression:"dataForm.connector"}},t._l(t.usernameList,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.username))])}))],1),a("FormItem",{attrs:{label:"关联主机:",prop:"hosts"}},[a("Select",{attrs:{filterable:"",multiple:""},model:{value:t.dataForm.hosts,callback:function(e){t.$set(t.dataForm,"hosts",e)},expression:"dataForm.hosts"}},t._l(t.hostsList,function(e){return a("Option",{key:e.id+":"+e.owner,attrs:{value:e.id+":"+e.owner}},[a("Tag",{staticStyle:{"margin-right":"10px"}},[a("b",[t._v(t._s(e.owner))])]),t._v(" "+t._s(e.hostname)+"\n          ")],1)}))],1),a("FormItem",{attrs:{label:"使用中:"}},[a("RadioGroup",{model:{value:t.dataForm.is_active,callback:function(e){t.$set(t.dataForm,"is_active",e)},expression:"dataForm.is_active"}},[a("Radio",{attrs:{label:"true"}},[t._v("是")]),a("Radio",{attrs:{label:"false"}},[t._v("否")])],1)],1),a("FormItem",{attrs:{label:"发布:"}},[a("RadioGroup",{model:{value:t.dataForm.is_publish,callback:function(e){t.$set(t.dataForm,"is_publish",e)},expression:"dataForm.is_publish"}},[a("Radio",{attrs:{label:"true"}},[t._v("是")]),a("Radio",{attrs:{label:"false"}},[t._v("否")])],1)],1),a("FormItem",{attrs:{label:"平台启动:"}},[a("RadioGroup",{model:{value:t.dataForm.is_launch,callback:function(e){t.$set(t.dataForm,"is_launch",e)},expression:"dataForm.is_launch"}},[a("Radio",{attrs:{label:"true"}},[t._v("是")]),a("Radio",{attrs:{label:"false"}},[t._v("否")])],1)],1),a("FormItem",{attrs:{label:"监控 (App Alive):"}},[a("RadioGroup",{model:{value:t.dataForm.is_monitor,callback:function(e){t.$set(t.dataForm,"is_monitor",e)},expression:"dataForm.is_monitor"}},[a("Radio",{attrs:{label:"true"}},[t._v("是")]),a("Radio",{attrs:{label:"false"}},[t._v("否")])],1),a("span",{staticStyle:{color:"red"}},[t._v("* 需要填写内外部检测信息")])],1),a("FormItem",{attrs:{label:"内部API检测:"}},[a("RadioGroup",{model:{value:t.dataForm.is_internal_check_api,callback:function(e){t.$set(t.dataForm,"is_internal_check_api",e)},expression:"dataForm.is_internal_check_api"}},[a("Radio",{attrs:{label:"true"}},[t._v("是")]),a("Radio",{attrs:{label:"false"}},[t._v("否")])],1)],1),a("FormItem",{directives:[{name:"show",rawName:"v-show",value:"true"===t.dataForm.is_internal_check_api,expression:"dataForm.is_internal_check_api === 'true'"}],attrs:{label:"内部检测API Uri:",prop:"internal_check_api"}},[a("Input",{attrs:{placeholder:"/info"},model:{value:t.dataForm.internal_check_api,callback:function(e){t.$set(t.dataForm,"internal_check_api","string"===typeof e?e.trim():e)},expression:"dataForm.internal_check_api"}})],1),a("FormItem",{directives:[{name:"show",rawName:"v-show",value:"true"===t.dataForm.is_internal_check_api,expression:"dataForm.is_internal_check_api === 'true'"}],attrs:{label:"内部需检测环境:",prop:"internal_check_api_env"}},[a("Select",{attrs:{filter:"",multiple:""},model:{value:t.dataForm.internal_check_api_env,callback:function(e){t.$set(t.dataForm,"internal_check_api_env",e)},expression:"dataForm.internal_check_api_env"}},t._l(t.envList,function(e){return a("Option",{key:e,attrs:{value:e}},[t._v("\n            "+t._s(e)+"\n          ")])}))],1),a("FormItem",{directives:[{name:"show",rawName:"v-show",value:"true"===t.dataForm.is_internal_check_api,expression:"dataForm.is_internal_check_api === 'true'"}],attrs:{label:"Urlooker Agent",prop:"chose_agent"}},[a("Input",{attrs:{disabled:""},model:{value:t.dataForm.chose_agent,callback:function(e){t.$set(t.dataForm,"chose_agent","string"===typeof e?e.trim():e)},expression:"dataForm.chose_agent"}}),a("p",{staticStyle:{color:"#2d8cf0","line-height":"15px","margin-top":"5px"}},[t._v('* 为不同环境选择不同urlooker agent; 现有 default, internal.agy.gz\n          json格式如: {"release": "default", "test92": "internal.ayg.gz"}\n        ')])],1),a("FormItem",{attrs:{label:"外部API检测:"}},[a("RadioGroup",{model:{value:t.dataForm.is_external_check_api,callback:function(e){t.$set(t.dataForm,"is_external_check_api",e)},expression:"dataForm.is_external_check_api"}},[a("Radio",{attrs:{label:"true"}},[t._v("是")]),a("Radio",{attrs:{label:"false"}},[t._v("否")])],1)],1),a("FormItem",{directives:[{name:"show",rawName:"v-show",value:"true"===t.dataForm.is_external_check_api,expression:"dataForm.is_external_check_api === 'true'"}],attrs:{label:"外部检测API:",prop:"external_check_api"}},[a("Input",{attrs:{placeholder:"http://ops-url.aiyuangong.com/deliver/info"},model:{value:t.dataForm.external_check_api,callback:function(e){t.$set(t.dataForm,"external_check_api","string"===typeof e?e.trim():e)},expression:"dataForm.external_check_api"}}),a("p",{staticStyle:{color:"#2d8cf0","line-height":"15px","margin-top":"5px"}},[t._v("* 外部检测API 不用设置urlooker agent; 默认直接使用default agent，\n          确保default能通外网")])],1)],1)],1),a("Modal",{attrs:{title:"批量关联主机"},on:{"on-ok":t.handlebatchCtrlHostOk},model:{value:t.batchControlHostModal,callback:function(e){t.batchControlHostModal=e},expression:"batchControlHostModal"}},[a("Alert",{attrs:{"show-icon":"",type:"warning"}},[t._v("批量增加或删除关联主机，若新增环境或减少环境则需要批量修改APP所属的环境监控")]),a("Form",{attrs:{model:t.batchCtrlHostForm,"label-width":80}},[a("FormItem",{attrs:{label:"批量添加: "}},[a("Checkbox",{model:{value:t.batchCtrlHostForm.is_add,callback:function(e){t.$set(t.batchCtrlHostForm,"is_add",e)},expression:"batchCtrlHostForm.is_add"}})],1),a("FormItem",{directives:[{name:"show",rawName:"v-show",value:t.batchCtrlHostForm.is_add,expression:"batchCtrlHostForm.is_add"}],attrs:{label:"Hosts: "}},[a("Select",{attrs:{multiple:"",filterable:""},model:{value:t.batchCtrlHostForm.add_hosts,callback:function(e){t.$set(t.batchCtrlHostForm,"add_hosts",e)},expression:"batchCtrlHostForm.add_hosts"}},t._l(t.hostsList,function(e){return a("Option",{key:e.id+":"+e.owner,attrs:{value:e.id+":"+e.owner}},[a("Tag",{staticStyle:{"margin-right":"10px"}},[a("b",[t._v(t._s(e.owner))])]),t._v(" "+t._s(e.hostname)+"\n          ")],1)}))],1),a("FormItem",{attrs:{label:"批量删除: "}},[a("Checkbox",{model:{value:t.batchCtrlHostForm.is_delete,callback:function(e){t.$set(t.batchCtrlHostForm,"is_delete",e)},expression:"batchCtrlHostForm.is_delete"}})],1),a("FormItem",{directives:[{name:"show",rawName:"v-show",value:t.batchCtrlHostForm.is_delete,expression:"batchCtrlHostForm.is_delete"}],attrs:{label:"Hosts: "}},[a("Select",{attrs:{multiple:"",filterable:""},model:{value:t.batchCtrlHostForm.delete_hosts,callback:function(e){t.$set(t.batchCtrlHostForm,"delete_hosts",e)},expression:"batchCtrlHostForm.delete_hosts"}},t._l(t.hostsList,function(e){return a("Option",{key:e.id+":"+e.owner,attrs:{value:e.id+":"+e.owner}},[a("Tag",{staticStyle:{"margin-right":"10px"}},[a("b",[t._v(t._s(e.owner))])]),t._v(" "+t._s(e.hostname)+"\n          ")],1)}))],1),a("FormItem",{attrs:{label:"已选择应用:"}},t._l(t.selectList,function(e){return a("p",{key:e.id},[t._v(t._s(e.app_name))])}))],1)],1),a("Modal",{attrs:{title:"批量操作修改监控APP所属环境"},on:{"on-ok":t.batchCtrlEnvModalOk},model:{value:t.batchCtrlEnvModal,callback:function(e){t.batchCtrlEnvModal=e},expression:"batchCtrlEnvModal"}},[a("Alert",{attrs:{"show-icon":"",type:"warning"}},[t._v("选择需要被监控的APP所属环境, 该环境会替换原有的监控环境")]),a("Form",{attrs:{model:t.batchCtrlEnvForm,"label-width":100}},[a("FormItem",{attrs:{label:"监控环境列表: "}},[a("Select",{attrs:{filter:"",multiple:""},model:{value:t.batchCtrlEnvForm.envList,callback:function(e){t.$set(t.batchCtrlEnvForm,"envList",e)},expression:"batchCtrlEnvForm.envList"}},t._l(t.envList,function(e){return a("Option",{key:e,attrs:{value:e}},[t._v("\n            "+t._s(e)+"\n          ")])}))],1),a("FormItem",{attrs:{label:"已选择应用:"}},t._l(t.selectList,function(e){return a("p",{key:e.id},[t._v(t._s(e.app_name))])}))],1)],1)],1)},n=[],o=(a("7f7f"),a("ac6a"),a("6b54"),a("53ca")),i=a("7c49"),s=a("c276"),c={name:"apps_app_management",watch:{"dataForm.is_external_check_api":function(t,e){"false"===t&&(this.dataForm.external_check_api="")},"dataForm.is_internal_check_api":function(t,e){"false"===t&&(this.dataForm.internal_check_api="",this.dataForm.internal_check_api_env=[])},appUsed:function(t,e){this.tableLoading=!0,this.tableDatas=!1===t?this.orginTableDatas:this.tableDatas.filter(function(t){if(t.is_active)return t}),this.pageTotal=this.tableDatas.length,this.tableLoading=!1}},data:function(){var t=this,e=function(t,e){return t("Icon",e?{props:{type:"md-checkmark-circle-outline"},style:{color:"#67C23A","font-size":"20px"}}:{props:{type:"ios-close-circle-outline"},style:{color:"#ed4014","font-size":"20px"}})},a=function(t,e,a){try{var r=JSON.parse(e);"object"!==Object(o["a"])(r)&&a(new Error('请输入 JSON 格式, 如 {"release": "default", "test92": "internal.ayg.gz", "preRelease": "default"}')),a()}catch(n){a(new Error('请输入 JSON 格式, 如 {"release": "default", "test92": "internal.ayg.gz"}'))}};return{envMonitorAgent:{},batchCtrlEnvForm:{envList:[]},batchCtrlEnvModal:!1,appUsed:!1,isCheckArr:["is_active","is_launch","is_publish","is_monitor","is_external_check_api","is_internal_check_api"],batchCtrlHostForm:{is_add:!1,add_hosts:[],is_delete:!1,delete_hosts:[]},batchControlHostModal:!1,tableLoading:!1,serviceList:[],usernameList:[],hostsList:[],urlookerAgentList:["default","internal.ayg.gz"],envList:[],editModalTitle:"",editModalAction:"",pageTotal:0,pageSize:20,ruleDataForm:{chose_agent:[{required:!0,validator:a,trigger:"blur",type:"string"}],app_name:[{required:!0,message:"必须填写",trigger:"blur"}],port:[{required:!0,message:"必须填写",trigger:"blur"}],description:[{required:!0,message:"必须填写",trigger:"blur"}],service:[{required:!0,message:"必须填写",trigger:"blur"}],connector:[{required:!0,message:"必须填写",trigger:"change",type:"array"}],hosts:[{required:!0,message:"必须填写",trigger:"change",type:"array"}]},originDataForm:{app_name:"",port:"",description:"",connector:[],is_active:"false",is_publish:"false",is_monitor:"false",is_launch:"false",is_internal_check_api:"false",is_external_check_api:"false",internal_check_api:"",internal_check_api_env:[],chose_agent:"",external_check_api:"",hosts:[],service:""},dataForm:{},editModal:!1,searchValue:"",orginTableDatas:[],tableDatas:[],selectList:[],searchList:["app_name"],tableColumns:[{type:"selection",width:50},{title:"应用名",key:"app_name",sortable:!0,width:150,render:function(e,a){return e("a",{on:{click:function(){var e=a.row.id,r=a.row.app_name,n={name:"apps_app_detail",params:{id:e},query:{app_name:r}};t.$router.push(n)}}},a.row.app_name)}},{title:"端口",key:"port",width:80},{title:"关联主机",render:function(e,a){var r=a.row.host_list,n=[];for(var o in r){var i=r[o],s=function(a){var r=i[a],s=r.id,c=r.hostname,l=r.private_ip,d=r.public_ip,u=r.cmdb;n.push(e("p",{},[e("a",{on:{click:function(){var e={name:"cmdb_host_info",params:{id:s},query:{hostname:c,cmdb:u}};t.$router.push(e)}}},"【".concat(u," - ").concat(o,"】 ").concat(r.hostname)),e("p",{},"（私）  ".concat(l)),e("p",{},"（公）  ".concat(d))]))};for(var c in i)s(c)}return e("div",{},n)}},{title:"服务",key:"service",width:80,align:"center",sortable:!0},{title:"使用中",key:"is_active",align:"center",width:90,sortable:!0,render:function(t,a){var r=a.row.is_active;return e(t,r)}},{title:"发布",key:"is_publish",align:"center",width:80,sortable:!0,render:function(t,a){var r=a.row.is_publish;return e(t,r)}},{title:"监控",key:"is_monitor",align:"center",width:80,sortable:!0,render:function(t,a){var r=a.row.is_monitor;return e(t,r)}},{title:"平台启动",key:"is_launch",align:"center",width:95,sortable:!0,render:function(t,a){var r=a.row.is_launch;return e(t,r)}},{title:"操作",width:60,align:"center",render:function(e,a){return e("div",{},[e("a",{},[e("Icon",{props:{type:"md-open"},on:{click:function(){var e=a.row;Object(i["h"])(e.id).then(function(a){var r=a.data.map(function(t){return"".concat(t.id,":").concat(t.owner)}),n=e.connector_detail.map(function(t){return t.id});t.dataForm["id"]=e.id,t.dataForm.app_name=e.app_name,t.dataForm.port=e.port,t.dataForm.description=e.description,t.dataForm.connector=n,t.dataForm.is_active=e.is_active.toString(),t.dataForm.is_publish=e.is_publish.toString(),t.dataForm.is_monitor=e.is_monitor.toString(),t.dataForm.is_launch=e.is_launch.toString(),t.dataForm.is_internal_check_api=e.is_internal_check_api.toString(),t.dataForm.is_external_check_api=e.is_external_check_api.toString(),t.dataForm.internal_check_api=e.internal_check_api,t.dataForm.internal_check_api_env=JSON.parse(e.internal_check_api_env),t.dataForm.chose_agent=JSON.stringify(t.envMonitorAgent),t.dataForm.external_check_api=e.external_check_api,t.dataForm.hosts=r,t.dataForm.service=e.service}),t.editApp()}},style:{"font-size":"20px"}})])])}}]}},methods:{pageChange:function(t){this.spliceTableDatas(t,this.orginTableDatas)},spliceTableDatas:function(t,e){this.tableDatas=e.slice(t*this.pageSize-this.pageSize,t*this.pageSize)},batchCtrlEnvModalOk:function(){var t=this,e=function(e){var a=t.selectList[e];for(var r in a.internal_check_api_env=JSON.stringify(t.batchCtrlEnvForm.envList),a.chose_agent=JSON.stringify(t.envMonitorAgent),t.isCheckArr)a[t.isCheckArr[r]]=!0===a[t.isCheckArr[r]]?1:0;Object(i["h"])(a.id).then(function(e){var r=e.data.map(function(t){return"".concat(t.id,":").concat(t.owner)}),n=a.connector_detail.map(function(t){return t.id});a.hosts=r,a.connector=n,console.log(a),Object(i["m"])(a.id,a).then(function(e){t.$Message.success("更新app成功");var a=e.data.id;Object(i["d"])(a).then(function(e){console.log(a),Object(i["b"])({app_id:a}).then(function(e){t.$Message.success("操作Urlooker监控")})})}).catch(function(t){Object(s["s"])("error",t)})}).catch(function(t){Object(s["s"])("error",t)})};for(var a in this.selectList)e(a)},handleBatchControlEnv:function(){0!==this.selectList.length?(this.batchCtrlEnvModal=!0,this.batchCtrlEnvForm.envList=[]):this.$Message.error("请选择需要操作的应用.")},handlebatchCtrlHostOk:function(){var t=this,e=function(e){var a=t.selectList[e];for(var r in t.isCheckArr)a[t.isCheckArr[r]]=!0===a[t.isCheckArr[r]]?1:0;Object(i["h"])(a.id).then(function(e){var r=e.data.map(function(t){return"".concat(t.id,":").concat(t.owner)}),n=a.connector_detail.map(function(t){return t.id});if(a.connector=n,t.batchCtrlHostForm.is_add&&t.batchCtrlHostForm.add_hosts.forEach(function(t){-1===r.indexOf(t)&&r.push(t)}),t.batchCtrlHostForm.is_delete){var o=[];t.batchCtrlHostForm.delete_hosts.forEach(function(t){r.indexOf(t)>-1&&o.push(t)}),o.forEach(function(t){r.pop(t)})}a.hosts=r,Object(i["m"])(a.id,a).then(function(e){t.$Message.success("更新app成功");var a=e.data.id;Object(i["d"])(a).then(function(e){console.log(a),Object(i["b"])({app_id:a}).then(function(e){t.$Message.success("操作Urlooker监控")})})}).catch(function(t){Object(s["s"])("error",t)})})};for(var a in this.selectList)e(a);this.selectList=[]},handleBatchControlHost:function(){console.log(this.selectList),this.batchCtrlHostForm={is_add:!1,add_hosts:[],is_delete:!1,delete_hosts:[]},0!==this.selectList.length?this.batchControlHostModal=!0:this.$Message.error("请选择需要操作的应用.")},enterSearch:function(){var t=this;this.tableDatas=[],this.searchList.forEach(function(e){t.orginTableDatas.forEach(function(a){a[e].toString().indexOf(t.searchValue)>-1&&t.tableDatas.push(a)})}),this.pageTotal=this.tableDatas.length},selectChange:function(t){this.selectList=t,console.log(t)},deleteOk:function(){var t=this;this.selectList&&this.selectList.forEach(function(e){Object(i["d"])(e.id).then(function(a){Object(i["c"])(e.id).then(function(e){t.$Message.success("删除 app 成功"),t.reloadTable()})}).catch(function(e){Object(s["s"])("error",e),t.reloadTable()})})},editOk:function(t){var e=this;("true"!==this.dataForm.is_internal_check_api||""!==this.dataForm.internal_check_api.trim()&&0!==this.dataForm.internal_check_api_env.length)&&("true"!==this.dataForm.is_external_check_api||""!==this.dataForm.external_check_api.trim())?this.$refs[t].validate(function(t){if(t){var a=e.editModalAction;"add"===a?e.addAppHandler():"update"===a&&e.updateAppHandler()}else e.$Message.error("信息未填完整.")}):this.$Message.error("信息未填写完整")},addApp:function(){this.dataForm=JSON.parse(JSON.stringify(this.originDataForm)),this.dataForm.chose_agent=JSON.stringify(this.envMonitorAgent),this.editModalTitle="添加 App",this.editModal=!0,this.editModalAction="add"},editApp:function(){this.editModalTitle="编辑 App",this.editModal=!0,this.editModalAction="update"},dataHandler:function(t){for(var e in this.isCheckArr)t[this.isCheckArr[e]]="true"===t[this.isCheckArr[e]]?1:0;return t.internal_check_api_env=JSON.stringify(t.internal_check_api_env),t},addAppHandler:function(){var t=this;this.dataForm=this.dataHandler(this.dataForm),Object(i["a"])(this.dataForm).then(function(e){t.$Message.success("创建app成功"),t.reloadTable(),Object(i["b"])({app_id:e.data.id}).then(function(e){t.$Message.success("操作Urlooker监控"),t.reloadTable()})}).catch(function(e){Object(s["s"])("error",e),t.reloadTable()})},updateAppHandler:function(){var t=this;this.dataForm=this.dataHandler(this.dataForm),console.log(this.dataForm),Object(i["m"])(this.dataForm.id,this.dataForm).then(function(e){t.$Message.success("更新app成功");var a=e.data.id;Object(i["d"])(a).then(function(e){Object(i["b"])({app_id:a}).then(function(e){t.$Message.success("操作Urlooker监控"),t.reloadTable()})})}).catch(function(e){Object(s["s"])("error",e),t.reloadTable()})},reloadTable:function(){var t=this;this.tableLoading=!0,Object(i["g"])().then(function(e){t.orginTableDatas=e.data.reverse(),t.tableDatas=t.orginTableDatas,t.tableLoading=!1,t.pageTotal=t.orginTableDatas.length}).catch(function(t){Object(s["s"])("error",t)})}},mounted:function(){var t=this;this.dataForm=JSON.parse(JSON.stringify(this.originDataForm)),this.reloadTable(),Object(i["e"])().then(function(e){t.hostsList=e.data}).catch(function(t){Object(s["s"])("error",t)}),Object(i["f"])().then(function(e){t.usernameList=e.data}).catch(function(t){Object(s["s"])("error",t)}),Object(i["j"])().then(function(e){t.envList=e.data[0]["cmdb_setting"]["base"]["env"],t.envList=t.envList.filter(function(t){if("external"!==t&&"undefined"!==t)return t})}).catch(function(t){Object(s["s"])("error",t)}),Object(i["i"])().then(function(e){t.envMonitorAgent=e.data[0]["app_setting"]["env_monitor_agent"]}).catch(function(t){Object(s["s"])("error",t)}),Object(i["k"])().then(function(e){t.serviceList=e.data[0]["app_setting"]["service"]}).catch(function(t){Object(s["s"])("error",t)})}},l=c,d=a("2877"),u=Object(d["a"])(l,r,n,!1,null,null,null);u.options.__file="app_management.vue";e["default"]=u.exports}}]);